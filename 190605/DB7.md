### 윈도우 함수

- RANK -랭킹을 찍고 싶을 때

```sql

SELECT ENAME, SAL,
RANK() OVER(ORDER BY SAL DESC) AS RANKING-- 중복 인정
FROM EMP
ORDER BY SAL DESC

SELECT ENAME, SAL,
DENSE_RANK() OVER (ORDER BY SAL DESC) AS D_RANKING -- 동률카운트를 해서 체크
FROM EMP
ORDER BY SAL DESC

SELECT ENAME, SAL,
ROW_NUMBER() OVER (ORDER BY SAL DESC) AS ROW_NUM-- 중복 인정 X
FROM EMP
ORDER BY SAL DESC
```

- 특정 범위 찍고 싶을 때

```sql

SELECT ENAME,SAL,ROW_NUM FROM(
SELECT ENAME, SAL,
ROW_NUMBER() OVER (ORDER BY SAL DESC) AS ROW_NUM
FROM EMP
)
WHERE ROW_NUM <= 5 -- 5위 이하 
```

- 몇명 중에 몇등인지 보고 싶을 때- COLUME에다 바로 서브쿼리 사용 가능

```sql
SELECT ENAME,SAL,RANK,
(SELECT COUNT(*) FROM EMP) AS TOTAL -- 전체 인원 수 구하기
 FROM(
SELECT ENAME, SAL,
RANK() OVER (ORDER BY SAL DESC) AS RANK
FROM EMP
)
WHERE RANK <=5
```

- 평균값을 보고 나타내고 싶을 때

```sql
SELECT ENAME,SAL,
ROUND((SELECT AVG(SAL) FROM EMP),2) AS ASAL, -- 평균값을 소수2번째 까지
RANK,
(SELECT COUNT(*) FROM EMP) AS TOTAL
 FROM(
SELECT ENAME, SAL,
RANK() OVER (ORDER BY SAL DESC) AS RANK
FROM EMP
)
WHERE RANK <=5
```

- ROLLUP - 합계와 소계를 한 번에 구한다.

```sql
SELECT JOB, SUM(SAL) FROM EMP
GROUP BY ROLLUP(JOB) -- 해당 부분 총 합계를 추출

SELECT JOB,AVG(SAL),SUM(SAL) FROM EMP
GROUP BY ROLLUP(JOB) -- 평균값과 합계의 총 합계 추출
```

